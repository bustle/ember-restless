(function(){"use strict";window.RESTless=Ember.Namespace.create({CURRENT_API_REVISION:1}),window.RL=window.RESTless})(),function(){"use strict";RESTless.RESTAdapter=Em.Object.extend({url:null,namespace:null,configurations:{plurals:{}},configure:function(e,t){var r=this.get("configurations");r[e]&&(r[e]=t)},rootPath:function(){var e=document.createElement("a"),t=this.get("url"),r=this.get("namespace"),s=r&&"/"===r.charAt(0);return e.href=t?t:"",r&&(e.pathname=s?r:e.pathname+r),e.href}.property("url","namespace"),request:function(e,t,r){var s=[this.get("rootPath"),t];return r&&s.push(r),e.url=s.join("/"),e.dataType="json",e.contentType="application/json; charset=utf-8",e.data&&"GET"!==e.type&&(e.data=JSON.stringify(e.data)),$.ajax(e)},deserialize:function(e,t){Em.beginPropertyChanges(e);var r;for(r in t)t.hasOwnProperty(r)&&this.deserializeProperty(e,r,t[r]);return Em.endPropertyChanges(e),e},deserializeProperty:function(e,t,r){var s=t.camelize();if(void 0!==Em.get(e,s)){var n=Em.get(e.constructor,"attributeMap"),i=n[s],a=i.get("type");if(i.get("hasMany")){var o=this.deserializeMany(e.get(s),a,r);return o.forEach(function(t){t.set("parentObject",e)}),e.set(s,o),void 0}if(i.get("belongsTo")){var u=Em.get(window,a).create();return this.deserialize(u,r),e.set(s,u),void 0}a&&RESTless.JSONTransforms[a]&&(r=RESTless.JSONTransforms[a].deserialize(r)),e.set(s,r)}},deserializeMany:function(e,t,r){var s,n,i=e,a=r.length,o=[];for(i?i.clear():i=RESTless.RESTArray.createWithContent({type:t}),n=0;a>n;n++)s=Em.get(window,t).create().deserialize(r[n]),o.push(s);return o.length&&i.pushObjects(o),i},serialize:function(e){var t,r,s=Em.get(e.constructor,"resourceName"),n=Em.get(e.constructor,"attributeMap"),i={};i[s]={};for(t in n)n.hasOwnProperty(t)&&(r=this.serializeProperty(e,t),null!==r&&(i[s][t.decamelize()]=r));return i},serializeProperty:function(e,t){var r=e.get(t),s=Em.get(e.constructor,"attributeMap"),n=s[t],i=n.get("type");return n.get("belongsTo")?null:n.get("hasMany")?this.serializeMany(r.get("content"),i):(i&&RESTless.JSONTransforms[i]&&(r=RESTless.JSONTransforms[i].serialize(r)),r)},serializeMany:function(e,t){var r,s=Em.get(Em.get(window,t),"resourceName"),n=[],i=e.length;for(r=0;i>r;r++){var a=e[r].serialize();n.push(a[s])}return n},registerTransform:function(e,t){Ember.assert("You are overwritting an existing transform: '"+e+"'",!RESTless.JSONTransforms[e]),RESTless.JSONTransforms[e]=t},extractMeta:function(e){return e&&e.meta?e.meta:void 0}}),RESTless.JSONTransforms={}}(),function(){"use strict";RESTless.RESTClient=Em.Object.extend({revision:RESTless.CURRENT_API_REVISION,adapter:RESTless.RESTAdapter.create()}),RESTless.set("client",RESTless.RESTClient.create()),Ember.onLoad("Ember.Application",function(e){e.initializer({name:"RESTClient",initialize:function(e,t){t.RESTClient&&RESTless.set("client",t.RESTClient)}})})}(),function(){"use strict";RESTless._Attribute=Em.ObjectProxy.extend({type:null,belongsTo:!1,hasMany:!1}),RESTless.attr=function(e){return RESTless._Attribute.create({type:e})},RESTless.belongsTo=function(e){return RESTless._Attribute.create({type:e,belongsTo:!0})},RESTless.hasMany=function(e){return RESTless._Attribute.create({type:e,hasMany:!0})}}(),function(){"use strict";RESTless.State=Em.Mixin.create(Em.Evented,{isLoaded:!1,isDirty:!1,isSaving:!1,isError:!1,errors:null,clearErrors:function(){return this.setProperties({isError:!1,errors:null}),this},copyState:function(e){return e.setProperties({isLoaded:this.get("isLoaded"),isDirty:this.get("isDirty"),isSaving:this.get("isSaving"),isError:this.get("isError"),errors:this.get("errors")})},_triggerEvent:function(e,t){Em.run(this,function(){this.trigger(e,t)})},_onError:function(e){var t;try{t=$.parseJSON(e)}catch(r){}this.setProperties({isError:!0,errors:t}),this._triggerEvent("becameError",this.get("errors"))}})}(),function(){"use strict";RESTless.NonObservable=Em.Mixin.create({nonObservable:!0})}(),function(){"use strict";RESTless.Model=Em.Object.extend(RESTless.State,Em.Copyable,{id:RESTless.attr("number"),currentRequest:null,isNew:function(){return!this.get("id")}.property("id"),init:function(){var e,t=Em.get(this.constructor,"attributeMap"),r=!this.get("nonObservable");for(e in t)t.hasOwnProperty(e)&&(t[e].get("hasMany")?(this.set(e,RESTless.RESTArray.createWithContent({type:t[e].get("type")})),r&&this.addObserver(e+".@each",this,this._onPropertyChange)):t[e].get("belongsTo")?(this.set(e,Em.get(window,t[e].get("type")).create()),r&&this.addObserver(e,this,this._onPropertyChange)):r&&this.addObserver(e,this,this._onPropertyChange))},_onPropertyChange:function(){var e=this.get("parentObject"),t=e||this;(t.get("isLoaded")||t.get("isNew"))&&t.set("isDirty",!0)},copy:function(){var e,t,r=this.constructor.create(),s=Em.get(this.constructor,"attributeMap");Em.beginPropertyChanges(this);for(e in s)s.hasOwnProperty(e)&&(t=this.get(e),null!==t&&r.set(e,t));return Em.endPropertyChanges(this),r},copyWithState:function(e){return this.copyState(this.copy(e))},serialize:function(){return RESTless.get("client.adapter").serialize(this)},deserialize:function(e){return RESTless.get("client.adapter").deserialize(this,e)},deserializeResource:function(e){var t=Em.get(this.constructor,"resourceName");return this.deserialize(e[t])},request:function(e){var t,r=Em.get(this.constructor,"resourceNamePlural"),s=this.get("id"),n=this;return!s&&e.data&&e.data.id&&(s=e.data.id,delete e.data.id),t=RESTless.get("client.adapter").request(e,r,s),this.set("currentRequest",t),t.always(function(){n.set("currentRequest",null)}),t},saveRecord:function(){if(!this.get("isNew")&&!this.get("isDirty"))return $.Deferred().resolve();this.set("isSaving",!0);var e=this,t=this.get("isNew"),r=t?"POST":"PUT",s=this.request({type:r,data:this.serialize()});return s.done(function(r){e.deserializeResource(r),e.clearErrors(),e.set("isDirty",!1),e._triggerEvent(t?"didCreate":"didUpdate")}).fail(function(t){e._onError(t.responseText)}).always(function(){e.set("isSaving",!1),e.set("isLoaded",!0),e._triggerEvent("didLoad")}),s},deleteRecord:function(){var e=this,t=this.request({type:"DELETE",data:this.serialize()});return t.done(function(){e._triggerEvent("didDelete"),e.destroy()}).fail(function(t){e._onError(t.responseText)}),t}}),RESTless.Model.reopenClass({resourceName:function(){var e=""+this,t=e.split("."),r=t[t.length-1].toLowerCase();return r}.property(),resourceNamePlural:function(){var e=Em.get(this,"resourceName"),t=RESTless.get("client.adapter.configurations").plurals;return t&&t[e]||e+"s"}.property("resourceName"),attributeMap:function(){var e,t=this.prototype,r={};for(e in t)t[e]instanceof RESTless._Attribute&&(r[e]=t[e],this.prototype[e]=null);return r}.property(),find:function(e){var t="string"==typeof e||"number"==typeof e;return t?this._findById(e):this.findAll(e)},findAll:function(e){var t=this,r=Em.get(this,"resourceNamePlural"),s=this.create(),n=RESTless.RESTArray.createWithContent(),i=s.request({type:"GET",data:e});return i.done(function(e){var s=e[r].map(function(e){return t.create().deserialize(e).set("isLoaded",!0)});n.pushObjects(s);var i=RESTless.get("client.adapter").extractMeta(e);i&&n.set("meta",i),n.clearErrors()}).fail(function(e){n._onError(e.responseText)}).always(function(){n.set("isLoaded",!0),n._triggerEvent("didLoad")}),n},_findById:function(e){var t=Em.get(this,"resourceName"),r=this.create(),s=r.request({type:"GET",data:{id:e}});return s.done(function(e){r.deserialize(e[t]),r.clearErrors()}).fail(function(e){r._onError(e.responseText)}).always(function(){r.set("isLoaded",!0),r._triggerEvent("didLoad")}),r}})}(),function(){"use strict";RESTless.RESTArray=Em.ArrayProxy.extend(RESTless.State,{type:null,createItem:function(e){var t,r=this.get("type");r&&(t=Em.get(window,r)||Em.Object),this.pushObject(t.create(e))}}),RESTless.RESTArray.reopenClass({createWithContent:function(e){var t=$.extend({content:Em.A()},e);return RESTless.RESTArray.create(t)}})}(),function(){"use strict";var e=Ember.isNone;RESTless.JSONTransforms={string:{deserialize:function(t){return e(t)?null:t+""},serialize:function(t){return e(t)?null:t+""}},number:{deserialize:function(t){return e(t)?null:Number(t)},serialize:function(t){return e(t)?null:Number(t)}},"boolean":{deserialize:function(e){var t=typeof e;return"boolean"===t?e:"string"===t?null!==e.match(/^true$|^t$|^1$/i):"number"===t?1===e:!1},serialize:function(e){return Boolean(e)}},date:{deserialize:function(e){var t=typeof e,r=null;return"string"===t||"number"===t?("string"===t&&-1!==e.search(/^\d{4}-\d{2}-\d{2}$/)&&(e+="T00:00:00Z"),r=new Date(e),"string"===t&&isNaN(r)&&(r=new Date(Date.parse(e.replace(/\-/gi,"/").replace(/Z$/,"").split(".")[0]))),r):null===e||void 0===e?e:null},serialize:function(e){if(e instanceof Date){var t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=function(e){return 10>e?"0"+e:""+e},n=e.getUTCFullYear(),i=e.getUTCMonth(),a=e.getUTCDate(),o=e.getUTCDay(),u=e.getUTCHours(),l=e.getUTCMinutes(),c=e.getUTCSeconds(),d=t[o],E=s(a),h=r[i];return d+", "+E+" "+h+" "+n+" "+s(u)+":"+s(l)+":"+s(c)+" GMT"}return null}}}}();